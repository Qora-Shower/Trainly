<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <link rel="stylesheet" href="linie.css">
  <title></title>
</head>

<body>
  <nav class="nav">
    <div class="i-btn">
      <i class="i" data-lucide="arrow-left"></i>
    </div>
      
      Verlauf
  </nav>
  
  <div class="cont2">
    <div id="position" class="verlauf"></div>
  
  <script>
    lucide.createIcons()
  </script>

 <div id="train-container"></div>

<script>
async function renderTrain(trainName) {
    try {
        const response = await fetch(`http://localhost:3000/train/${trainName}`);
        const data = await response.json();
        const stations = data.stations;

        const container = document.getElementById('train-container');
        container.innerHTML = ''; // vorher leeren

        stations.forEach((station, index) => {
            // Icon, Farben und Platform-Style bestimmen
            let iconClass, iconLucide, textColor, platStyle;

            if (index === 0) { // Startstation
                iconClass = 'i3';
                iconLucide = 'circle-dot';
                textColor = '#fff';
                platStyle = 'background:#02084D;color:#fff;';
            } else if (index === stations.length - 1) { // Endstation
                iconClass = 'i3';
                iconLucide = 'map-pin';
                textColor = '#fff';
                platStyle = 'background:#02084D;color:#fff;';
            } else { // Zwischenstationen
                iconClass = 'i2';
                iconLucide = 'circle';
                textColor = station.changes > 0 ? '#FF0000' : '#212121';
                platStyle = 'background:none;color:' + textColor + ';';
            }

            // Fallbacks für Startstation
            const abfahrt = station.abfahrt || "--:--";
            const vsl = station.vsl || "--:--";
            const name = station.name || "Unbekannt";

            // HTML für die Station erstellen
            const stationDiv = document.createElement('div');
            stationDiv.id = station.name;
            stationDiv.className = 'station';
            stationDiv.innerHTML = `
                <div class="time">
                    <div class="plan" style="color:${textColor}">${abfahrt}</div>
                    <div class="vsl" style="color:${textColor}">${vsl}</div>
                </div>
                <i class="${iconClass}" data-lucide="${iconLucide}" style="color:${textColor}"></i>
                <p class="Name" style="color:${textColor}">${name}</p>
                <div class="platform" style="${platStyle}">Gl. ${station.gleis}</div>
            `;

            container.appendChild(stationDiv);
        });

    } catch (err) {
        console.error("Fehler beim Laden der Zugdaten:", err);
    }
}

// Beispiel: RE13 laden
renderTrain('RE13');


</script>


</body>

</html>